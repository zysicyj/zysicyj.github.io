<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>【Kafka 系列】（二）Kafka 的基本使用 | </title><meta name="keywords" content="Kafka,Linux,Windows,垃圾回收器,部署,性能,集群,Mac,操作系统,文件系统,网络栈,硬件资源管理,零拷贝,阻塞 I/O,非阻塞 I/O,I/O 多路复用,信号驱动 I/O,异步 I/O,磁盘,RAID,机械磁盘,磁盘容量,带宽,带宽资源,带宽利用率,预留资源,数据处理目标,I/O 模型,操作系统优化,文件系统选择,网络栈性能,社区支持度,集群参数配置,静态参数,动态参数,Broker,磁盘相关,log.dirs,log.dir,Zookeeper相关,zookeeper.connect,chroot,Broker相关,listeners,主机名,端口号,Topic相关,auto.create.topics.enable,unclean.leader.election.enable,auto.leader.rebalance.enable,数据留存方面,log.retention,log.retention.bytes,message.max.bytes,Topic级别参数,JVM参数,堆大小,KAFKA_HEAP_OPTS,KAFKA_JVM_PERFORMANCE_OPTS"><meta name="author" content="程序员朱永胜"><meta name="copyright" content="程序员朱永胜"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="【Kafka 系列】（二）Kafka 的基本使用"><meta name="application-name" content="【Kafka 系列】（二）Kafka 的基本使用"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="【Kafka 系列】（二）Kafka 的基本使用"><meta property="og:url" content="https://blog.zysicyj.top/kafka2.html"><meta property="og:site_name" content=""><meta property="og:description" content="有的时候博客内容会有变动，首发博客是最新的，其他博客地址可能会未同步, 认准https:&amp;#x2F;&amp;#x2F;blog.zysicyj.top  系列文章地址  Kafka 线上集群部署方案怎么做  操作系统  先说结论，Kafka 部署在 Linux 上要比 Windows 和 Mac 上性能高的多，主要是以下几"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://img.xjh.me/random_img.php?return=302&amp;_r_=9a8ced0a-506a-6936-ec2f-c76e2d8d2fa7"><meta property="article:author" content="程序员朱永胜"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img.xjh.me/random_img.php?return=302&amp;_r_=9a8ced0a-506a-6936-ec2f-c76e2d8d2fa7"><meta name="description" content="有的时候博客内容会有变动，首发博客是最新的，其他博客地址可能会未同步, 认准https:&amp;#x2F;&amp;#x2F;blog.zysicyj.top  系列文章地址  Kafka 线上集群部署方案怎么做  操作系统  先说结论，Kafka 部署在 Linux 上要比 Windows 和 Mac 上性能高的多，主要是以下几"><link rel="shortcut icon" href="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/aliyun/202308012321669.jpg"><link rel="canonical" href="https://blog.zysicyj.top/kafka2.html"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-9343722716173603',
  enable_page_level_ads: 'true'
});</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?16bc6435aa26c2ae803ad0e62e4f5fa8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: {"enable":true,"ck":"3Is8EMFcqgGHzmLJ","LingQueMonitorID":"3Is8EMFcqgGHzmLJ"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":1},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 程序员朱永胜","link":"链接: ","source":"来源: ","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: {"enable":true,"delay":100,"shiftDelay":200},
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '',
  title: '【Kafka 系列】（二）Kafka 的基本使用',
  postAI: '',
  pageFillDescription: 'Kafka 线上集群部署方案怎么做 ,  操作系统 , Ix2FO 模型 , 零拷贝, 磁盘 , 为什么说 Kafka 可以不搭建 RAID 环境, 为什么说使用机械磁盘完全能够胜任 Kafka 线上环境, 磁盘容量 , 带宽 , 小结, 集群参数配置 ,  静态参数和动态参数 , Broker, 磁盘相关 , Zookeeper 相关, Broker 相关 , Topic 相关 , auto.create.topics.enable, unclean.leader.election.enable, auto.leader.rebalance.enable, 数据留存方面 , Topic 级别参数, JVM 参数, 操作系统参数有的时候博客内容会有变动首发博客是最新的其他博客地址可能会未同步认准系列文章地址线上集群部署方案怎么做操作系统先说结论部署在上要比和上性能高的多主要是以下几个原因是的在上的性能通常比在和上要高得多这是由于以下几个原因操作系统优化操作系统在网络和文件系统性能方面通常比和更优秀内核对网络和磁盘的处理更高效能够更好地利用硬件资源从而提高的性能文件系统选择上常用的文件系统如等对大规模数据处理和高并发读写有更好的支持而上的文件系统在处理大量小文件和高并发读写时性能相对较差网络栈性能的网络栈在处理高并发连接和大规模数据传输时表现更出色内核对网络协议栈的优化更多能够更好地处理网络数据包提高的吞吐量和响应速度硬件资源管理操作系统对硬件资源的管理更加灵活和高效上的进程调度内存管理等机制能够更好地利用多核处理器和大内存提高的并发处理能力社区支持度模型主流的模型通常有以下五种类型阻塞在进行操作时应用程序会被阻塞直到数据准备好或者操作完成这种模型是最简单的但是会导致应用程序的性能下降因为在等待完成时无法处理其他任务非阻塞在进行操作时应用程序可以继续执行其他任务而不会被阻塞但是如果数据还没有准备好或者操作还没有完成应用程序需要不断地轮询来检查状态这会导致的资源浪费多路复用通过使用或者等系统调用应用程序可以同时监视多个文件描述符的状态当任何一个文件描述符准备好进行操作时应用程序就可以进行相应的读写操作这种模型可以有效地处理多个连接提高系统的并发性能信号驱动应用程序通过注册信号处理函数在数据准备好时接收到一个信号然后进行相应的读写操作这种模型相比于非阻塞减少了轮询的开销但是仍然需要应用程序不断地检查数据是否准备好异步应用程序发起一个操作后可以继续执行其他任务当数据准备好或者操作完成时操作系统会通知应用程序进行相应的读写操作这种模型是最高效的因为应用程序不需要进行轮询或者阻塞等待可以充分利用的资源你不必详细了解每一种模型的实现细节通常情况下我们认为后一种模型会比前一种模型要高级比如就比要好了解到这一程度应该足以应付我们下面的内容了说了这么多模型与的关系又是什么呢实际上客户端底层使用了的在上的实现机制是而在平台上的实现机制是因此在这一点上将部署在上是有优势的因为能够获得更高效的性能零拷贝在上支持零拷贝的主要原因是操作系统提供了一些特性和系统调用使得零拷贝成为可能而操作系统在设计上与有所不同因此不直接支持零拷贝零拷贝是一种优化技术可以减少数据在内核空间和用户空间之间的拷贝次数提高数据传输的效率在传统的拷贝方式中数据从磁盘读取到内核缓冲区然后再从内核缓冲区拷贝到用户空间的应用程序缓冲区这涉及到多次数据拷贝操作增加了和内存的开销在上零拷贝的实现主要依赖以下几个特性和系统调用文件描述符使用文件描述符来表示打开的文件通过文件描述符可以进行文件的读写操作内核缓冲区内核提供了一块内存区域作为内核缓冲区用于存放从磁盘读取的数据系统调用系统调用可以在内核空间和用户空间之间直接传输数据而无需经过用户空间缓冲区通过使用系统调用可以直接将数据从磁盘读取到内核缓冲区然后通过网络发送给消费者避免了数据在内核空间和用户空间之间的多次拷贝而在上没有类似于的系统调用因此无法直接实现零拷贝在上数据需要经过内核空间和用户空间之间的多次拷贝导致性能上的损失一句话总结一下在部署能够享受到零拷贝技术所带来的快速数据传输特性磁盘先说结论追求性价比的公司可以不搭建使用普通磁盘组成存储空间即可使用机械磁盘完全能够胜任线上环境为什么说可以不搭建环境分布式架构采用分布式架构将消息分散存储在多个节点上每个节点都是独立的它们之间相互复制消息实现数据的冗余和高可用性因此即使某个节点的磁盘发生故障其他节点仍然可以提供服务不会导致数据丢失数据复制使用副本机制来保证数据的可靠性每个分区都可以配置多个副本这些副本分布在不同的节点上当消息写入到副本后会将消息复制到其他副本确保数据的冗余存储如果某个副本所在的磁盘发生故障会自动选择其他副本作为保证数据的可用性持久化存储将消息持久化存储在磁盘上而不是仅保存在内存中这样即使节点发生故障消息也不会丢失使用顺序写入的方式将消息追加到磁盘上的日志文件中这种方式对磁盘的要求相对较低不需要特别高的磁盘性能水平扩展支持水平扩展可以通过增加节点来提高系统的吞吐量和容量在扩展过程中可以选择在新节点上添加磁盘而不需要对现有节点进行改动这种方式可以灵活地根据需求来调整磁盘的配置和容量为什么说使用机械磁盘完全能够胜任线上环境是一个高吞吐量低延迟的分布式消息系统它的性能和稳定性对于线上环境非常重要虽然固态硬盘在性能方面有明显的优势但机械磁盘仍然可以胜任线上环境的原因如下顺序写入的特点之一是顺序写入即消息按照顺序追加到日志文件中机械磁盘在顺序写入方面的性能表现通常比较好因为它们具有较大的磁道和扇区可以更好地支持连续写入操作容量成本低相比于机械磁盘的容量成本更低对于大规模的集群存储成本是一个重要的考虑因素机械磁盘可以提供更大的存储容量使得能够存储更多的消息数据持久性和可靠性机械磁盘通常具有更高的持久性和可靠性它们在写入数据时通常会将数据缓存在磁盘的缓存区中然后再进行持久化写入这种写入方式可以提供更好的数据可靠性即使在断电等异常情况下数据也不容易丢失成熟稳定机械磁盘是一种成熟的存储设备已经在各种应用场景中得到广泛应用相比之下虽然在性能方面有优势但在稳定性和寿命方面可能存在一些问题对于对数据可靠性要求较高的线上环境机械磁盘可能更受信任需要注意的是尽管机械磁盘可以胜任线上环境但在某些特定场景下如对延迟要求非常高的应用或者对存储容量要求非常大的应用可能需要考虑使用等更高性能的存储设备此外随着技术的发展未来可能会有更多新型存储设备出现对于的存储需求可能会有不同的选择磁盘容量总结下磁盘容量需要考虑的因素新增消息数消息留存时间平均消息大小备份数是否启用压缩我举一个简单的例子来说明该如何思考这个问题假设你所在公司有个业务每天需要向集群发送亿条消息每条消息保存两份以防止数据丢失另外消息默认保存两周时间现在假设消息的平均大小是那么你能说出你的集群需要为这个业务预留多少磁盘空间吗我们来计算一下每天亿条大小的消息保存两份且留存两周的时间那么总的空间大小就等于亿一般情况下集群除了消息数据还有其他类型的数据比如索引数据等故我们再为这些数据预留出的磁盘空间因此总的存储容量就是既然要保存两周那么整体容量即为大约左右支持数据的压缩假设压缩比是那么最后你需要规划的存储空间就是带宽举个例子我们使用以下假设和计算带宽资源假设机房环境是千兆网络即每秒处理的数据带宽利用率假设服务器最多使用的带宽资源即每秒最多使用的带宽预留资源为了避免网络丢包我们额外预留了的带宽资源即单台服务器使用带宽数据处理目标在小时内处理的业务数据即每秒需要处理的数据根据以上计算我们得出了需要台服务器来完成这个业务目标这个计算还没有考虑到消息的复制如果消息需要额外复制两份那么总的服务器台数还要乘以即需要台服务器在实际部署中你可以根据自己的网络环境和业务需求进行调整和优化另外如果你的环境中还涉及跨机房传输那么带宽资源的瓶颈可能会更加明显在跨机房传输的情况下网络延迟和带宽限制都会对性能产生影响你可能需要考虑使用更高带宽的网络或者采取其他优化措施来解决这个问题总结起来对于带宽资源的规划你需要考虑以下几个因素网络带宽根据网络环境确定每秒处理的数据量带宽利用率根据实际情况确定服务器使用的带宽比例预留资源为了避免网络丢包额外预留一部分带宽资源数据处理目标根据业务需求确定每秒需要处理的数据量消息复制如果消息需要复制考虑复制的数量根据以上因素你可以计算出所需的服务器数量并根据实际情况进行调整和优化小结集群参数配置静态参数和动态参数静态参数是指在启动时配置的参数一旦设置后只能通过重启来更改这些参数通常是对整体行为的全局设置例如的监听端口日志目录副本数量等静态参数的配置通常在的配置文件如中进行动态参数是指在运行时可以动态修改的参数而无需重启这些参数通常是对的某个特定组件或功能进行细粒度的调整动态参数可以通过的命令行工具或进行修改磁盘相关在中是消息队列的核心组件负责接收存储和转发消息为了配置存储信息我们需要设置一些重要的参数这是一个非常重要的参数用于指定使用的文件目录路径这个参数没有默认值因此必须由用户自己指定在生产环境中建议为配置多个路径以提高读写性能和实现故障转移具体格式是一个格式多个路径之间用逗号分隔例如如果有条件的话最好将这些目录挂载到不同的物理磁盘上以提高性能和可靠性这是的补充参数用于指定单个路径在实际使用中我们只需要设置参数即可不需要设置为什么要为配置多个路径呢这是因为多块物理磁盘同时读写数据可以提高吞吐量同时也能实现故障转移在版本之前如果使用的任何一块磁盘挂掉了整个进程都会关闭但是从版本开始引入了功能坏掉的磁盘上的数据会自动转移到其他正常的磁盘上仍然可以正常工作这个改进使得我们不再依赖来提供数据的可靠性而是通过多块磁盘的故障转移来实现需要注意的是如果使用了多个路径会根据一定的策略将消息分配到不同的路径上以实现负载均衡同时也会自动管理磁盘空间当某个路径的磁盘空间不足时会自动将消息转移到其他路径上总结一下为了配置存储信息我们需要设置参数为其配置多个路径最好挂载到不同的物理磁盘上这样可以提高读写性能和实现故障转移同时会自动管理磁盘空间和实现负载均衡这些配置可以在的配置文件中进行设置相关是一个分布式协调框架用于协调和管理集群的元数据信息它负责保存集群的配置信息例如的运行状态的创建情况分区信息以及副本的位置等在中与相关的最重要的参数是这个参数是一个格式的字符串用于指定连接到集群的地址和端口例如表示连接到三个节点默认端口为如果要让多个集群共享同一个集群可以使用参数来进行区分是的概念类似于别名假设有两个集群分别命名为和那么可以将参数设置为和这样就可以通过来区分不同的集群需要注意的是只需要在参数中指定一次并且应该添加到最后有时候会遇到这样的错误格式这是不正确的总结一下设置与相关的参数时需要注意以下几点参数是一个格式的字符串用于指定连接到集群的地址和端口如果多个集群共享同一个集群可以使用参数来进行区分参数只需要在参数中指定一次并且应该添加到最后下面是一个示例配置这个配置表示连接到三个节点并使用作为相关在中参数用于指定外部连接者通过什么协议访问服务它是一个逗号分隔的三元组列表每个三元组由协议名称主机名和端口号组成协议名称可以是标准的协议如表示明文传输表示使用或加密传输等也可以是自定义的协议名称举个例子如果你定义了一个名为的自定义协议你可以在参数中添加表示该协议通过的端口进行通信需要注意的是如果你自定义了协议名称你还需要通过参数告诉使用哪种安全协议比如如果你定义了协议并且该协议使用明文传输数据你需要设置另外主机名和端口号比较直观不需要过多解释但是需要注意的是建议在端和客户端应用的配置中都使用主机名而不是地址因为在的源代码中也是使用主机名进行连接的如果你在某些地方使用了地址进行连接可能会导致连接失败的问题总结一下参数用于指定服务的监听器告诉外部连接者通过什么协议访问它是一个三元组列表每个三元组由协议名称主机名和端口号组成建议使用主机名而不是地址进行配置如果使用自定义协议还需要通过参数指定安全协议相关该参数用于控制是否允许自动创建建议将该参数设置为即不允许自动创建在线上环境中如果该参数被设置为可能会导致出现很多名字稀奇古怪的例如当我们想要为名为的发送事件时由于拼写错误将写成了启动生产者程序后一个名为的就会被自动创建这种情况下好的运维应该防止这种情况的发生特别是对于大公司而言每个部门被分配的应该由运维严格把控不允许自行创建任何该参数用于控制是否允许选举选举是指在中当保存数据较多的副本都挂掉时是否允许从保存数据较少的副本中选举出新的在中每个分区都有多个副本来提供高可用性其中只有一个副本对外提供服务即副本只有保存数据较多的副本才有资格竞选而那些落后进度太多的副本没有资格竞选如果设置为那么将坚持之前的原则坚决不允许那些落后太多的副本竞选这样做的后果是该分区将不可用因为没有如果设置为那么允许从那些保存数据较少的副本中选举出新的这样做的后果是数据有可能丢失因为这些副本保存的数据本来就不全当成为后它本身就变得膨胀了认为自己的数据才是权威的需要注意的是该参数在最新版的中默认为但是由于社区对该参数的默认值进行了多次更改所以建议在使用时显式地将其设置为该参数用于控制是否允许定期进行选举建议将该参数设置为设置为表示允许定期对一些分区进行重选举需要满足一定的条件才会触发重选举与参数不同的是并不是选举新的而是更换现有的例如如果一直表现良好但是当为时经过一段时间后可能会被强制卸任换成需要注意的是的更换代价很高原本向发送请求的所有客户端都需要切换成向发送请求而且这种的更换本质上没有任何性能收益因此在生产环境中建议将设置为避免不必要的更换数据留存方面在中有一组参数用于控制数据的留存下面我将逐个介绍这些参数这是一组参数用于控制消息数据在中保存的时间这三个参数分别是以小时分钟和毫秒为单位的时间间隔优先级上设置最高次之最低通常情况下我们会设置较长的时间间隔比如表示默认保存天的数据自动删除天前的数据如果将用作存储系统那么这个值可能需要相应调大这个参数用于指定在磁盘上保存的消息数据的总容量大小默认值为表示没有容量限制即可以保存任意大小的数据这个参数在构建云上的多租户集群时发挥作用假设你要提供一个云上的服务每个租户只能使用的磁盘空间为了避免某个租户占用过多的磁盘空间设置这个参数就非常重要了这个参数用于控制能够接收的最大消息大小默认值为即不到然而在实际场景中超过的消息是很常见的因此在生产环境中将这个值设置得比较大是比较保险的做法这个参数只是一个标尺仅仅衡量能够处理的最大消息大小即使设置得大一点也不会占用太多磁盘空间需要注意的是这些参数都是可配置的可以根据实际需求进行调整在配置文件中可以通过设置对应的属性来修改这些参数的值例如可以在文件中添加以下配置来修改参数的值这样就将消息数据的保存时间设置为天总结一下这些参数在中起到了重要的作用可以根据实际需求来调整以满足不同的业务场景级别参数级别的参数在中非常重要它允许我们为每个设置特定的参数值这些参数会覆盖全局参数的值这样做的好处是可以根据不同的业务需求为不同的设置不同的参数提高系统的灵活性和效率下面我将详细介绍几个重要的级别参数按照用途分组保存消息方面的参数规定了该消息被保存的时长默认值是天即该只保存最近天的消息如果设置了这个值它会覆盖端的全局参数值通过设置不同的值我们可以根据业务需求来控制消息的保存时长避免无效的数据占用过多的存储空间规定了为该预留的磁盘空间大小和全局参数的作用类似这个值在多租户的集群中非常有用默认值是表示可以无限使用磁盘空间通过设置不同的值我们可以根据不同的的数据量来合理分配磁盘空间避免存储空间不足的问题处理消息大小方面的参数决定了能够正常接收该的最大消息大小在很多公司中作为基础架构组件运行承载了大量的业务数据如果在全局层面上无法给出一个合适的最大消息值那么允许不同的业务部门自行设定级别的参数就显得非常必要了通过设置不同的值我们可以根据不同的业务需求来控制消息的大小确保系统能够正常处理各种大小的消息通过设置级别的参数我们可以根据不同的业务需求来灵活地调整的配置提高系统的性能和可用性同时这也是作为一个高性能分布式消息系统的重要特性之一需要注意的是级别的参数只对该中的消息生效不会影响其他如果没有为某个设置特定的参数值那么将会使用全局参数的默认值除了上述介绍的参数还有其他一些级别的参数如等它们都可以根据具体的业务需求进行设置在实际应用中我们可以根据不同的场景和需求灵活地使用这些参数来优化集群的性能和可靠性总结一下级别的参数允许我们为每个设置特定的参数值覆盖全局参数的值通过设置不同的参数值我们可以根据业务需求来控制消息的保存时长磁盘空间使用和消息大小等提高系统的灵活性和效率这是作为一个高性能分布式消息系统的重要特性之一在中可以通过两种方式来设置级别的参数在创建时设置和修改已存在的时设置创建时设置参数在创建时可以通过参数来设置级别的参数例如我们要创建一个名为的并设置为为可以使用以下命令在上述命令中后面的参数用于指定要设置的级别参数修改已存在的时设置参数可以使用命令来修改已存在的的参数假设我们要将的修改为可以使用以下命令在上述命令中表示要修改的实体类型为表示要修改的名称表示要进行修改操作后面的参数用于指定要修改的级别参数及其新值个人建议个人建议始终坚持使用第二种方式来设置级别参数并且在未来社区很有可能统一使用脚本来调整级别参数这样做的好处是统一了设置参数的方式减少了学习成本和混淆同时也更加方便管理和维护参数参数对于集群的性能和稳定性非常重要在设置参数之前首先需要确定版本对于来说不推荐在或的环境上运行建议至少使用在参数设置中堆大小是一个关键参数尽管后面我们还会讨论如何调优性能的问题但是现在我想给出一个通用的建议将堆大小设置为这是目前业界普遍认可的一个合理值很多人使用默认的堆大小来运行但是默认的有点小因为在与客户端进行交互时会在堆上创建大量的实例堆大小不能太小另一个重要的参数是垃圾回收器的设置如果你仍在使用可以根据以下规则选择合适的垃圾回收器如果所在机器的资源非常充裕建议使用收集器启用方法是指定否则使用吞吐量收集器启用方法是指定如果你使用可以手动设置使用收集器在没有任何调优的情况下表现要比更出色主要体现在更少的和需要调整的参数更少等方面所以使用就可以了现在我们确定了要设置的参数接下来我们来为进行设置奇怪的是这个问题在官网上居然没有被提及实际上设置的方法非常简单你只需要设置下面这两个环境变量即可指定堆大小例如你可以这样设置指定参数例如你可以这样设置在启动之前先设置好这两个环境变量然后执行启动命令例如这样就完成了参数的设置通过合理的设置可以提高集群的性能和稳定性需要注意的是具体的参数设置可能因环境和需求而有所不同可以根据实际情况进行调整操作系统参数集群通常需要设置一些操作系统参数来优化性能和稳定性下面是一些常见的操作系统参数设置文件描述符限制文件描述符是操作系统用于跟踪打开文件的标识符集群需要同时打开大量的文件描述符因此需要增加文件描述符限制默认情况下操作系统的文件描述符限制较低可能会导致进程无法打开足够的文件描述符从而影响性能建议将文件描述符限制设置为一个较大的值例如文件系统类型的选择集群的性能和稳定性受到文件系统的影响根据官方测试报告文件系统的性能要优于文件系统因此在生产环境中最好选择文件系统最近也有一些关于使用文件系统的报告显示其性能更强劲如果条件允许可以尝试使用文件系统的调优是操作系统用于将内存中不常用的数据暂时存储在磁盘上的机制一些文章建议将设置为完全禁用以防止进程使用空间然而个人认为最好不要将设置为而是设置为一个较小的值这是因为当物理内存耗尽时操作系统会触发组件随机选择一个进程并杀死它而不给用户任何预警如果将设置为一个较小的值当开始使用空间时你至少能观察到性能的急剧下降从而有时间进行进一步的调优和问题诊断建议将设置为接近但不为的值例如提交时间落盘时间发送数据时并不需要等待数据被写入磁盘才认为成功只要数据被写入操作系统的页缓存即可操作系统会根据算法定期将页缓存上的脏数据写入物理磁盘提交时间决定了这个定期的间隔默认为秒通常情况下这个时间间隔可能太频繁可以适当增加提交时间间隔来降低物理磁盘的写操作需要注意的是如果数据在写入磁盘之前发生机器宕机数据将会丢失但由于在软件层面提供了多副本的冗余机制因此可以适当增加提交时间间隔以换取性能需要注意的是以上参数设置是一般情况下的建议具体的设置还需要根据实际情况和硬件配置进行调整另外不同的操作系统和版本可能会有不同的参数设置方式请参考相应的操作系统文档或官方建议进行设置下面是一个示例展示如何在系统上设置参数查看当前文件描述符限制修改文件描述符限制为验证修改是否生效请注意以上示例仅适用于系统其他操作系统可能有不同的设置方式程序员朱永胜',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-01-22 07:09:19',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="atom.xml" title="" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.zysicyj.top/" title="个人主页"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/13/64d8c2748ef34.jpg" alt="个人主页"/><span class="back-menu-item-text">个人主页</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">写作软件</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://editor.runjs.cool/post?id=demo" title="Mdx"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4296739868700.png" alt="Mdx"/><span class="back-menu-item-text">Mdx</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://openwrite.cn/" title="OpenWrite"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://openwrite.cn/logo.png" alt="OpenWrite"/><span class="back-menu-item-text">OpenWrite</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jetbrains.com/zh-cn/writerside/" title="WriteSide"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="data:image/jpeg;base64,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" alt="WriteSide"/><span class="back-menu-item-text">WriteSide</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">开发工具</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jetbrains.com/zh-cn/idea/" title="idea"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4576710485000.png" alt="idea"/><span class="back-menu-item-text">idea</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jetbrains.com/zh-cn/datagrip/" title="DataGrip"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4604435065400.png" alt="DataGrip"/><span class="back-menu-item-text">DataGrip</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4663369180700.png" title="WebStorm"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4604435065400.png" alt="WebStorm"/><span class="back-menu-item-text">WebStorm</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" title="微信开发者工具"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4743988475500.png" alt="微信开发者工具"/><span class="back-menu-item-text">微信开发者工具</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" title="HBuilder"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://www.dcloud.io/hbuilderx.html" alt="HBuilder"/><span class="back-menu-item-text">HBuilder</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://mobaxterm.mobatek.net/" title="MobaXterm"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4849682167700.png" alt="MobaXterm"/><span class="back-menu-item-text">MobaXterm</span></a></div></div></div></div><a id="site-name" href="index.html" accesskey="h"><div class="title"></div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)" rel="external nofollow noreferrer">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="index.html"><i class="fas fa-home faa-tada"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-link faa-tada"></i><span> 目录</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fas fa-archive faa-tada"></i><span> 时间轴</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fas fa-folder-open faa-tada"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-list faa-tada"></i><span> 清单</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/movies/"><i class="fas fa-video faa-tada"></i><span> 电影</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/books/"><i class="fas fa-book faa-tada"></i><span> 阅读</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/songs/"><i class="fas fa-music faa-tada"></i><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="fa-brands fa-bilibili faa-tada"></i><span> 追番</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/cinemas/"><i class="fa-brands fa-bilibili faa-tada"></i><span> 追剧</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="fas fa-link faa-tada"></i><span> 友链</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/gallery/"><i class="fas fa-solid fa-image faa-tada"></i><span> 相册集</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/love/static/index.html"><i class="fas fa-heart faa-tada"></i><span> Love</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="fa-solid fa-user faa-tada"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="fa-solid  fa-comment faa-tada"></i><span> 闲言碎语</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/blog/202308142337659.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" alt="wechat" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/blog/202308142337659.png"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/blog/202308142338230.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" alt="alipay" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/blog/202308142338230.png"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="tags/2024%E5%B9%B4/" style="font-size: 1.05rem;">2024年<sup>1</sup></a><a href="tags/2024%E5%B9%B47%E6%9C%88/" style="font-size: 1.05rem;">2024年7月<sup>1</sup></a><a href="tags/2%E6%97%A5/" style="font-size: 1.05rem;">2日<sup>1</sup></a><a href="tags/7%E6%9C%88/" style="font-size: 1.05rem;">7月<sup>1</sup></a><a href="tags/Butterfly/" style="font-size: 1.05rem;">Butterfly<sup>2</sup></a><a href="tags/CSS/" style="font-size: 1.05rem;">CSS<sup>2</sup></a><a href="tags/Docker-Compose%E5%AE%89%E8%A3%85Space/" style="font-size: 1.05rem;">Docker Compose安装Space<sup>1</sup></a><a href="tags/GithubPages/" style="font-size: 1.05rem;">GithubPages<sup>3</sup></a><a href="tags/Github%E9%85%8D%E7%BD%AE/" style="font-size: 1.05rem;">Github配置<sup>2</sup></a><a href="tags/Hexo/" style="font-size: 1.05rem;">Hexo<sup>7</sup></a><a href="tags/NR/" style="font-size: 1.05rem;">NR<sup>8</sup></a><a href="tags/Redis%E9%9B%86%E7%BE%A4/" style="font-size: 1.05rem;">Redis集群<sup>1</sup></a><a href="tags/github/" style="font-size: 1.05rem;">github<sup>1</sup></a><a href="tags/gossip%E5%8D%8F%E8%AE%AE/" style="font-size: 1.05rem;">gossip协议<sup>1</sup></a><a href="tags/hexo/" style="font-size: 1.05rem;">hexo<sup>1</sup></a><a href="tags/nari/" style="font-size: 1.05rem;">nari<sup>22</sup></a><a href="tags/xxc/" style="font-size: 1.05rem;">xxc<sup>1</sup></a><a href="tags/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/" style="font-size: 1.05rem;">个人博客<sup>2</sup></a><a href="tags/%E5%85%8D%E8%B4%B9/" style="font-size: 1.05rem;">免费<sup>2</sup></a><a href="tags/%E5%85%8D%E8%B4%B9%E6%9C%8D%E5%8A%A1/" style="font-size: 1.05rem;">免费服务<sup>1</sup></a><a href="tags/%E5%86%85%E5%AD%98%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.05rem;">内存数据库<sup>1</sup></a><a href="tags/%E5%8D%95%E7%BA%BF%E7%A8%8B/" style="font-size: 1.05rem;">单线程<sup>1</sup></a><a href="tags/%E5%8F%91%E5%B8%83%E6%96%87%E7%AB%A0/" style="font-size: 1.05rem;">发布文章<sup>2</sup></a><a href="tags/%E5%95%86%E5%93%81/" style="font-size: 1.05rem;">商品<sup>9</sup></a><a href="tags/%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/" style="font-size: 1.05rem;">多路复用<sup>1</sup></a><a href="tags/%E5%AE%89%E8%A3%85Hexo/" style="font-size: 1.05rem;">安装Hexo<sup>2</sup></a><a href="tags/%E6%90%AD%E5%BB%BA/" style="font-size: 1.05rem;">搭建<sup>2</sup></a><a href="tags/%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/" style="font-size: 1.05rem;">数据同步<sup>1</sup></a><a href="tags/%E6%97%A5%E8%AE%B0/" style="font-size: 1.05rem;">日记<sup>14</sup></a><a href="tags/%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/" style="font-size: 1.05rem;">更新日志<sup>10</sup></a><a href="tags/%E6%A7%BD%E5%88%86%E9%85%8D/" style="font-size: 1.05rem;">槽分配<sup>1</sup></a><a href="tags/%E7%9F%A5%E5%90%8D%E9%A1%B9%E7%9B%AE-Redis/" style="font-size: 1.05rem;">知名项目/Redis<sup>2</sup></a><a href="tags/%E7%BD%91%E7%AB%99/" style="font-size: 1.05rem;">网站<sup>2</sup></a><a href="tags/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/" style="font-size: 1.05rem;">网站搭建<sup>1</sup></a><a href="tags/%E8%8A%82%E7%82%B9%E9%80%9A%E4%BF%A1/" style="font-size: 1.05rem;">节点通信<sup>1</sup></a><a href="tags/%E8%AE%BF%E9%97%AE/" style="font-size: 1.05rem;">访问<sup>2</sup></a><a href="tags/%E8%B5%84%E6%BA%90/" style="font-size: 1.05rem;">资源<sup>9</sup></a><a href="tags/%E9%85%8D%E7%BD%AEhexo-deployer-git/" style="font-size: 1.05rem;">配置hexo-deployer-git<sup>2</sup></a><a href="tags/%E9%9B%86%E7%BE%A4%E5%88%86%E7%89%87/" style="font-size: 1.05rem;">集群分片<sup>1</sup></a><a href="tags/%E9%AB%98%E6%80%A7%E8%83%BD/" style="font-size: 1.05rem;">高性能<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">16</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">66</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">16</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">27</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div><div class="console-btn-item" id="consoleKeyboard" onclick="anzhiyu.keyboardToggle()" title="快捷键开关"><a class="keyboard-switch"><i class="anzhiyufont anzhiyu-icon-keyboard"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);" rel="external nofollow noreferrer"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a></div></div><h1 class="post-title" itemprop="name headline">【Kafka 系列】（二）Kafka 的基本使用</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2023-09-18T21:33:10.000Z" title="发表于 2023-09-18 21:33:10">2023-09-18</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-01-22T07:09:19.218Z" title="更新于 2025-01-22 07:09:19">2025-01-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">9.2k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>29分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="【Kafka 系列】（二）Kafka 的基本使用"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为南京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>南京</span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="https://blog.zysicyj.top/kafka2.html"><header><h1 id="CrawlerTitle" itemprop="name headline">【Kafka 系列】（二）Kafka 的基本使用</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">程序员朱永胜</span><time itemprop="dateCreated datePublished" datetime="2023-09-18T21:33:10.000Z" title="发表于 2023-09-18 21:33:10">2023-09-18</time><time itemprop="dateCreated datePublished" datetime="2025-01-22T07:09:19.218Z" title="更新于 2025-01-22 07:09:19">2025-01-22</time></header><div id="readmore-container"><link rel="stylesheet external nofollow noreferrer" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><blockquote>
<p>有的时候博客内容会有变动，首发博客是最新的，其他博客地址可能会未同步, 认准<code>https://blog.zysicyj.top</code></p>
</blockquote>
<p><a href="https://blog.zysicyj.top/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/Kafka/">系列文章地址</a></p>
<hr>
<h1 id="Kafka 线上集群部署方案怎么做"><a href="#Kafka 线上集群部署方案怎么做" class="headerlink" title="Kafka 线上集群部署方案怎么做"></a>Kafka 线上集群部署方案怎么做 </h1><h2 id="操作系统"><a href="# 操作系统" class="headerlink" title="操作系统"></a> 操作系统 </h2><p> 先说结论，Kafka 部署在 Linux 上要比 Windows 和 Mac 上性能高的多，主要是以下几个原因：</p>
<p>是的，Kafka 在 Linux 上的性能通常比在 Windows 和 Mac 上要高得多。这是由于以下几个原因：</p>
<ol>
<li><p><strong>操作系统优化</strong>：Linux 操作系统在网络和文件系统性能方面通常比 Windows 和 Mac 更优秀。Linux 内核对网络和磁盘 I&#x2F;O 的处理更高效，能够更好地利用硬件资源，从而提高 Kafka 的性能。</p>
</li>
<li><p><strong>文件系统选择</strong>：Linux 上常用的文件系统如 ext4、XFS 等对大规模数据处理和高并发读写有更好的支持。而 Windows 上的 NTFS 文件系统在处理大量小文件和高并发读写时性能相对较差。</p>
</li>
<li><p><strong>网络栈性能</strong>：Linux 的网络栈在处理高并发连接和大规模数据传输时表现更出色。Linux 内核对网络协议栈的优化更多，能够更好地处理网络数据包，提高 Kafka 的吞吐量和响应速度。</p>
</li>
<li><p><strong>硬件资源管理</strong>：Linux 操作系统对硬件资源的管理更加灵活和高效。Linux 上的进程调度、内存管理等机制能够更好地利用多核处理器和大内存，提高 Kafka 的并发处理能力。</p>
</li>
<li><p><strong>社区支持度</strong></p>
</li>
</ol>
<h3 id="I-O 模型"><a href="#I-O 模型" class="headerlink" title="I&#x2F;O 模型"></a>I&#x2F;O 模型 </h3><p> 主流的 I&#x2F;O 模型通常有以下五种类型：</p>
<ol>
<li><p>阻塞 I&#x2F;O（Blocking I&#x2F;O）：在进行 I&#x2F;O 操作时，应用程序会被阻塞，直到数据准备好或者操作完成。这种模型是最简单的，但是会导致应用程序的性能下降，因为在等待 I&#x2F;O<br>完成时，CPU 无法处理其他任务。</p>
</li>
<li><p>非阻塞 I&#x2F;O（Non-blocking I&#x2F;O）：在进行 I&#x2F;O 操作时，应用程序可以继续执行其他任务，而不会被阻塞。但是，如果数据还没有准备好或者操作还没有完成，应用程序需要不断地轮询来检查状态，这会导致 CPU<br>的资源浪费。</p>
</li>
<li><p>I&#x2F;O 多路复用（I&#x2F;O Multiplexing）：通过使用 select、poll 或者 epoll 等系统调用，应用程序可以同时监视多个文件描述符的状态，当任何一个文件描述符准备好进行<br>I&#x2F;O 操作时，应用程序就可以进行相应的读写操作。这种模型可以有效地处理多个连接，提高系统的并发性能。</p>
</li>
<li><p>信号驱动 I&#x2F;O（Signal-driven<br>I&#x2F;O）：应用程序通过注册信号处理函数，在数据准备好时接收到一个信号，然后进行相应的读写操作。这种模型相比于非阻塞 I&#x2F;O，减少了轮询的开销，但是仍然需要应用程序不断地检查数据是否准备好。</p>
</li>
<li><p>异步 I&#x2F;O（Asynchronous I&#x2F;O）：应用程序发起一个 <br>I&#x2F;O 操作后，可以继续执行其他任务，当数据准备好或者操作完成时，操作系统会通知应用程序进行相应的读写操作。这种模型是最高效的，因为应用程序不需要进行轮询或者阻塞等待，可以充分利用 CPU<br> 的资源。</p>
</li>
</ol>
<p>你不必详细了解每一种模型的实现细节，通常情况下我们认为后一种模型会比前一种模型要高级，比如 epoll 就比 select<br>要好，了解到这一程度应该足以应付我们下面的内容了。</p>
<p>说了这么多，I&#x2F;O 模型与 Kafka 的关系又是什么呢？实际上 Kafka 客户端底层使用了 Java 的 selector，selector 在 Linux<br>上的实现机制是 epoll，而在 Windows 平台上的实现机制是 select。因此在这一点上 <strong> 将 Kafka 部署在 Linux 上是有优势的，因为能够获得更高效的<br>I&#x2F;O 性能</strong>。</p>
<h3 id="零拷贝"><a href="# 零拷贝" class="headerlink" title="零拷贝"></a>零拷贝</h3><p>Kafka 在 Linux 上支持零拷贝（Zero-copy）的主要原因是 Linux 操作系统提供了一些特性和系统调用，使得零拷贝成为可能。而 Windows 操作系统在设计上与 Linux 有所不同，因此不直接支持零拷贝。</p>
<p>零拷贝是一种优化技术，可以减少数据在内核空间和用户空间之间的拷贝次数，提高数据传输的效率。在传统的拷贝方式中，数据从磁盘读取到内核缓冲区，然后再从内核缓冲区拷贝到用户空间的应用程序缓冲区，这涉及到多次数据拷贝操作，增加了 CPU 和内存的开销。</p>
<p>在 Linux 上，零拷贝的实现主要依赖以下几个特性和系统调用：</p>
<ol>
<li><p>文件描述符（File Descriptor）：Linux 使用文件描述符来表示打开的文件，通过文件描述符可以进行文件的读写操作。</p>
</li>
<li><p>内核缓冲区（Kernel Buffer）：Linux 内核提供了一块内存区域作为内核缓冲区，用于存放从磁盘读取的数据。</p>
</li>
<li><p>sendfile 系统调用：sendfile 系统调用可以在内核空间和用户空间之间直接传输数据，而无需经过用户空间缓冲区。</p>
</li>
</ol>
<p>通过使用 sendfile 系统调用，Kafka 可以直接将数据从磁盘读取到内核缓冲区，然后通过网络发送给消费者，避免了数据在内核空间和用户空间之间的多次拷贝。</p>
<p>而在 Windows 上，没有类似于 Linux 的 sendfile 系统调用，因此无法直接实现零拷贝。在 Windows 上，数据需要经过内核空间和用户空间之间的多次拷贝，导致性能上的损失。</p>
<p><strong>一句话总结一下，在 Linux 部署 Kafka 能够享受到零拷贝技术所带来的快速数据传输特性。</strong></p>
<h2 id="磁盘"><a href="# 磁盘" class="headerlink" title="磁盘"></a>磁盘 </h2><p> 先说结论：</p>
<ul>
<li>追求性价比的公司可以不搭建 RAID，使用普通磁盘组成存储空间即可</li>
<li>使用机械磁盘完全能够胜任 Kafka 线上环境</li>
</ul>
<h3 id="为什么说 Kafka 可以不搭建 RAID 环境"><a href="# 为什么说 Kafka 可以不搭建 RAID 环境" class="headerlink" title="为什么说 Kafka 可以不搭建 RAID 环境"></a>为什么说 Kafka 可以不搭建 RAID 环境</h3><ol>
<li><p><strong>分布式架构</strong><br>：Kafka 采用分布式架构，将消息分散存储在多个 Broker 节点上。每个 Broker 节点都是独立的，它们之间相互复制消息，实现数据的冗余和高可用性。因此，即使某个节点的磁盘发生故障，其他节点仍然可以提供服务，不会导致数据丢失。</p>
</li>
<li><p><strong>数据复制</strong><br>：Kafka 使用副本机制来保证数据的可靠性。每个分区都可以配置多个副本，这些副本分布在不同的 Broker 节点上。当消息写入到 Leader 副本后，Kafka 会将消息复制到其他副本，确保数据的冗余存储。如果某个副本所在的磁盘发生故障，Kafka 会自动选择其他副本作为 Leader，保证数据的可用性。</p>
</li>
<li><p><strong>持久化存储</strong><br>：Kafka 将消息持久化存储在磁盘上，而不是仅保存在内存中。这样即使 Broker 节点发生故障，消息也不会丢失。Kafka 使用顺序写入的方式将消息追加到磁盘上的日志文件中，这种方式对磁盘的要求相对较低，不需要特别高的磁盘性能。</p>
</li>
<li><p><strong>水平扩展</strong>：Kafka 支持水平扩展，可以通过增加 Broker 节点来提高系统的吞吐量和容量。在扩展过程中，可以选择在新节点上添加磁盘，而不需要对现有节点进行改动。这种方式可以灵活地根据需求来调整磁盘的配置和容量。</p>
</li>
</ol>
<h3 id="为什么说使用机械磁盘完全能够胜任 Kafka 线上环境"><a href="# 为什么说使用机械磁盘完全能够胜任 Kafka 线上环境" class="headerlink" title="为什么说使用机械磁盘完全能够胜任 Kafka 线上环境"></a>为什么说使用机械磁盘完全能够胜任 Kafka 线上环境</h3><p>Kafka 是一个高吞吐量、低延迟的分布式消息系统，它的性能和稳定性对于线上环境非常重要。虽然 SSD（固态硬盘）在性能方面有明显的优势，但机械磁盘仍然可以胜任 Kafka 线上环境的原因如下：</p>
<ol>
<li><p><strong>顺序写入</strong>：Kafka 的特点之一是顺序写入，即消息按照顺序追加到日志文件中。机械磁盘在顺序写入方面的性能表现通常比较好，因为它们具有较大的磁道和扇区，可以更好地支持连续写入操作。</p>
</li>
<li><p><strong>容量成本低</strong>：相比于 SSD，机械磁盘的容量成本更低。对于大规模的 Kafka 集群，存储成本是一个重要的考虑因素。机械磁盘可以提供更大的存储容量，使得 Kafka 能够存储更多的消息数据。</p>
</li>
<li><p><strong>持久性和可靠性</strong>：机械磁盘通常具有更高的持久性和可靠性。它们在写入数据时，通常会将数据缓存在磁盘的缓存区中，然后再进行持久化写入。这种写入方式可以提供更好的数据可靠性，即使在断电等异常情况下，数据也不容易丢失。</p>
</li>
<li><p><strong>成熟稳定</strong>：机械磁盘是一种成熟的存储设备，已经在各种应用场景中得到广泛应用。相比之下，SSD 虽然在性能方面有优势，但在稳定性和寿命方面可能存在一些问题。对于对数据可靠性要求较高的线上环境，机械磁盘可能更受信任。</p>
</li>
</ol>
<p>需要注意的是，尽管机械磁盘可以胜任 Kafka 线上环境，但在某些特定场景下，如对延迟要求非常高的应用，或者对存储容量要求非常大的应用，可能需要考虑使用 SSD 等更高性能的存储设备。此外，随着技术的发展，未来可能会有更多新型存储设备出现，对于 Kafka 的存储需求可能会有不同的选择。</p>
<h2 id="磁盘容量"><a href="# 磁盘容量" class="headerlink" title="磁盘容量"></a>磁盘容量 </h2><p> 总结下磁盘容量需要考虑的因素：</p>
<ul>
<li>新增消息数</li>
<li>消息留存时间</li>
<li>平均消息大小</li>
<li>备份数</li>
<li>是否启用压缩</li>
</ul>
<p>我举一个简单的例子来说明该如何思考这个问题。假设你所在公司有个业务每天需要向 Kafka 集群发送 1<br>亿条消息，每条消息保存两份以防止数据丢失，另外消息默认保存两周时间。现在假设消息的平均大小是 1KB，那么你能说出你的<br>Kafka 集群需要为这个业务预留多少磁盘空间吗？</p>
<p>我们来计算一下：每天 1 亿条 1KB<br>大小的消息，保存两份且留存两周的时间，那么总的空间大小就等于 <code>1 亿 * 1KB * 2 / 1000 / 1000 = 200GB</code>。一般情况下 Kafka<br>集群除了消息数据还有其他类型的数据，比如索引数据等，故我们再为这些数据预留出 10% 的磁盘空间，因此总的存储容量就是<br>220GB。既然要保存两周，那么整体容量即为 220GB * 14，大约 3TB 左右。Kafka 支持数据的压缩，假设压缩比是<br>0.75，那么最后你需要规划的存储空间就是 <code>0.75 * 3 = 2.25TB</code>。</p>
<h2 id="带宽"><a href="# 带宽" class="headerlink" title="带宽"></a>带宽 </h2><p> 举个例子，我们使用以下假设和计算：</p>
<ol>
<li>带宽资源：假设机房环境是千兆网络（1Gbps），即每秒处理 1Gb 的数据。</li>
<li>带宽利用率：假设 Kafka 服务器最多使用 70% 的带宽资源，即每秒最多使用 700Mb 的带宽。</li>
<li>预留资源：为了避免网络丢包，我们额外预留了 2&#x2F;3 的带宽资源，即单台服务器使用带宽 240Mbps。</li>
<li>数据处理目标：在 1 小时内处理 1TB 的业务数据，即每秒需要处理 2336Mb 的数据。</li>
</ol>
<p>根据以上计算，我们得出了需要 10 台 Kafka 服务器来完成这个业务目标。这个计算还没有考虑到消息的复制，如果消息需要额外复制两份，那么总的服务器台数还要乘以 3，即需要 30 台服务器。</p>
<p>在实际部署中，你可以根据自己的网络环境和业务需求进行调整和优化。</p>
<p>另外，如果你的环境中还涉及跨机房传输，那么带宽资源的瓶颈可能会更加明显。在跨机房传输的情况下，网络延迟和带宽限制都会对性能产生影响。你可能需要考虑使用更高带宽的网络或者采取其他优化措施来解决这个问题。</p>
<p>总结起来，对于带宽资源的规划，你需要考虑以下几个因素：</p>
<ol>
<li>网络带宽：根据网络环境确定每秒处理的数据量。</li>
<li>带宽利用率：根据实际情况确定 Kafka 服务器使用的带宽比例。</li>
<li>预留资源：为了避免网络丢包，额外预留一部分带宽资源。</li>
<li>数据处理目标：根据业务需求确定每秒需要处理的数据量。</li>
<li>消息复制：如果消息需要复制，考虑复制的数量。</li>
</ol>
<p>根据以上因素，你可以计算出所需的 Kafka 服务器数量，并根据实际情况进行调整和优化。</p>
<h2 id="小结"><a href="# 小结" class="headerlink" title="小结"></a>小结</h2><p><a target="_blank" rel="noopener external nofollow noreferrer" href="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2023-09-18/46348146460000.png" class="gallery-item"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2023-09-18/46348146460000.png"></a></p>
<h1 id="集群参数配置"><a href="# 集群参数配置" class="headerlink" title="集群参数配置"></a>集群参数配置 </h1><h2 id="静态参数和动态参数"><a href="# 静态参数和动态参数" class="headerlink" title="静态参数和动态参数"></a> 静态参数和动态参数 </h2><p> 静态参数是指在 Kafka 启动时配置的参数，一旦设置后，只能通过重启 Kafka 来更改。这些参数通常是对 Kafka 整体行为的全局设置，例如 Kafka 的监听端口、日志目录、副本数量等。静态参数的配置通常在 Kafka 的配置文件（如 server.properties）中进行。</p>
<p>动态参数是指在 Kafka 运行时可以动态修改的参数，而无需重启 Kafka。这些参数通常是对 Kafka 的某个特定组件或功能进行细粒度的调整。动态参数可以通过 Kafka 的命令行工具或 API 进行修改。</p>
<h2 id="Broker"><a href="#Broker" class="headerlink" title="Broker"></a>Broker</h2><h3 id="磁盘相关"><a href="# 磁盘相关" class="headerlink" title="磁盘相关"></a>磁盘相关 </h3><p> 在 Kafka 中，Broker 是消息队列的核心组件，负责接收、存储和转发消息。为了配置存储信息，我们需要设置一些重要的参数。</p>
<ol>
<li><p>log.dirs：这是一个非常重要的参数，用于指定 Broker 使用的文件目录路径。这个参数没有默认值，因此必须由用户自己指定。在生产环境中，建议为 <br>log.dirs 配置多个路径，以提高读写性能和实现故障转移。具体格式是一个 CSV<br> 格式，多个路径之间用逗号分隔，例如：<code>/home/kafka1,/home/kafka2,/home/kafka3</code>。如果有条件的话，最好将这些目录挂载到不同的物理磁盘上，以提高性能和可靠性。</p>
</li>
<li><p>log.dir：这是 log.dirs 的补充参数，用于指定单个路径。在实际使用中，我们只需要设置 log.dirs 参数即可，不需要设置 log.dir。</p>
</li>
</ol>
<p>为什么要为 log.dirs 配置多个路径呢？这是因为多块物理磁盘同时读写数据可以提高吞吐量，同时也能实现故障转移。在 Kafka 1.1<br>版本之前，如果 Broker 使用的任何一块磁盘挂掉了，整个 Broker 进程都会关闭。但是从 Kafka 1.1 版本开始，引入了 Failover<br>功能，坏掉的磁盘上的数据会自动转移到其他正常的磁盘上，Broker 仍然可以正常工作。这个改进使得我们不再依赖 RAID<br>来提供数据的可靠性，而是通过多块磁盘的故障转移来实现。</p>
<p>需要注意的是，如果使用了多个路径，Kafka 会根据一定的策略将消息分配到不同的路径上，以实现负载均衡。同时，Kafka<br>也会自动管理磁盘空间，当某个路径的磁盘空间不足时，会自动将消息转移到其他路径上。</p>
<p>总结一下，为了配置存储信息，我们需要设置 log.dirs 参数，为其配置多个路径，最好挂载到不同的物理磁盘上。这样可以提高读写性能和实现故障转移。同时，Kafka<br>会自动管理磁盘空间和实现负载均衡。这些配置可以在 Kafka 的配置文件中进行设置。</p>
<h3 id="Zookeeper 相关"><a href="#Zookeeper 相关" class="headerlink" title="Zookeeper 相关"></a>Zookeeper 相关</h3><p>ZooKeeper 是一个分布式协调框架，用于协调和管理 Kafka 集群的元数据信息。它负责保存 Kafka 集群的配置信息，例如 Broker 的运行状态、Topic 的创建情况、分区信息以及 Leader 副本的位置等。</p>
<p>在 Kafka 中，与 ZooKeeper 相关的最重要的参数是 <code>zookeeper.connect</code><br>。这个参数是一个 CSV 格式的字符串，用于指定连接到 ZooKeeper 集群的地址和端口。例如，<code>zk1:2181,zk2:2181,zk3:2181</code><br> 表示连接到三个 ZooKeeper 节点，默认端口为 2181。</p>
<p>如果要让多个 Kafka 集群共享同一个 ZooKeeper 集群，可以使用 <code>chroot</code> 参数来进行区分。<code>chroot</code><br>是 ZooKeeper 的概念，类似于别名。假设有两个 Kafka 集群，分别命名为 kafka1 和 kafka2，那么可以将 <code>zookeeper.connect</code><br> 参数设置为 <code>zk1:2181,zk2:2181,zk3:2181/kafka1</code> 和<code>zk1:2181,zk2:2181,zk3:2181/kafka2</code>。这样就可以通过 <code>chroot</code> 来区分不同的 Kafka 集群。</p>
<p>需要注意的是，<code>chroot</code><br>只需要在参数中指定一次，并且应该添加到最后。有时候会遇到这样的错误格式：<code>zk1:2181/kafka1,zk2:2181/kafka2,zk3:2181/kafka3</code><br>，这是不正确的。</p>
<p>总结一下，设置与 ZooKeeper 相关的参数时，需要注意以下几点：</p>
<ol>
<li><code>zookeeper.connect</code>参数是一个 CSV 格式的字符串，用于指定连接到 ZooKeeper 集群的地址和端口。</li>
<li>如果多个 Kafka 集群共享同一个 ZooKeeper 集群，可以使用 <code>chroot</code> 参数来进行区分。</li>
<li><code>chroot</code>参数只需要在参数中指定一次，并且应该添加到最后。</li>
</ol>
<p>下面是一个示例配置：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">zookeeper</span>.connect=zk1:<span class="number">2181</span>,zk2:<span class="number">2181</span>,zk3:<span class="number">2181</span>/kafka1</span><br></pre></td></tr></table></figure>

<p>这个配置表示连接到三个 ZooKeeper 节点，并使用 <code>kafka1</code> 作为<code>chroot</code>。</p>
<h3 id="Broker 相关"><a href="#Broker 相关" class="headerlink" title="Broker 相关"></a>Broker 相关 </h3><p> 在 Kafka 中，listeners 参数用于指定外部连接者通过什么协议访问 Kafka 服务。它是一个逗号分隔的三元组列表，每个三元组由协议名称、主机名和端口号组成。协议名称可以是标准的协议，如<br>PLAINTEXT 表示明文传输，SSL 表示使用 SSL 或 TLS 加密传输等，也可以是自定义的协议名称。</p>
<p>举个例子，如果你定义了一个名为 CONTROLLER 的自定义协议，你可以在 listeners 参数中添加 <code>CONTROLLER://localhost:9092</code><br>，表示该协议通过 localhost 的 9092 端口进行通信。</p>
<p>需要注意的是，如果你自定义了协议名称，你还需要通过 <code>listener.security.protocol.map</code> 参数告诉 Kafka 使用哪种安全协议。比如，如果你定义了<br>CONTROLLER 协议，并且该协议使用明文传输数据，你需要设置 <code>listener.security.protocol.map=CONTROLLER:PLAINTEXT</code>。</p>
<p>另外，主机名和端口号比较直观，不需要过多解释。但是需要注意的是，建议在 Broker 端和客户端应用的配置中都使用主机名而不是 IP<br>地址。因为在 Kafka 的源代码中，也是使用主机名进行连接的。如果你在某些地方使用了 IP 地址进行连接，可能会导致连接失败的问题。</p>
<p>总结一下，listeners 参数用于指定 Kafka 服务的监听器，告诉外部连接者通过什么协议访问 <br>Kafka。它是一个三元组列表，每个三元组由协议名称、主机名和端口号组成。建议使用主机名而不是 IP<br> 地址进行配置。如果使用自定义协议，还需要通过 <code>listener.security.protocol.map</code>参数指定安全协议。</p>
<h3 id="Topic 相关"><a href="#Topic 相关" class="headerlink" title="Topic 相关"></a>Topic 相关 </h3><h4 id="auto-create-topics-enable"><a href="#auto-create-topics-enable" class="headerlink" title="auto.create.topics.enable"></a>auto.create.topics.enable</h4><p> 该参数用于控制是否允许自动创建 Topic。建议将该参数设置为 false，即不允许自动创建 Topic。</p>
<p>在线上环境中，如果该参数被设置为 true，可能会导致出现很多名字稀奇古怪的 Topic。例如，当我们想要为名为 test 的 Topic 发送事件时，由于拼写错误将 test 写成了 tst，启动生产者程序后，一个名为 tst 的 Topic 就会被自动创建。这种情况下，好的运维应该防止这种情况的发生，特别是对于大公司而言，每个部门被分配的 Topic 应该由运维严格把控，不允许自行创建任何 Topic。</p>
<h4 id="unclean-leader-election-enable"><a href="#unclean-leader-election-enable" class="headerlink" title="unclean.leader.election.enable"></a>unclean.leader.election.enable</h4><p>该参数用于控制是否允许 Unclean Leader 选举。Unclean Leader 选举是指在 Kafka 中，当保存数据较多的副本都挂掉时，是否允许从保存数据较少的副本中选举出新的 Leader。</p>
<p>在 Kafka 中，每个分区都有多个副本来提供高可用性，其中只有一个副本对外提供服务，即 Leader 副本。只有保存数据较多的副本才有资格竞选 Leader，而那些落后进度太多的副本没有资格竞选。</p>
<p>如果设置 <code>unclean.leader.election.enable</code> 为 false，那么 Kafka 将坚持之前的原则，坚决不允许那些落后太多的副本竞选 Leader。这样做的后果是该分区将不可用，因为没有 Leader。</p>
<p>如果设置 <code>unclean.leader.election.enable</code><br> 为 true，那么 Kafka 允许从那些保存数据较少的副本中选举出新的 Leader。这样做的后果是数据有可能丢失，因为这些副本保存的数据本来就不全，当成为 Leader 后，它本身就变得膨胀了，认为自己的数据才是权威的。</p>
<p>需要注意的是，该参数在最新版的 Kafka 中默认为 false。但是由于社区对该参数的默认值进行了多次更改，所以建议在使用时显式地将其设置为 false。</p>
<h4 id="auto-leader-rebalance-enable"><a href="#auto-leader-rebalance-enable" class="headerlink" title="auto.leader.rebalance.enable"></a>auto.leader.rebalance.enable</h4><p>该参数用于控制是否允许 Kafka 定期进行 Leader 选举。建议将该参数设置为 false。</p>
<p>设置 <code>auto.leader.rebalance.enable</code> 为 true 表示允许 Kafka 定期对一些 Topic 分区进行 Leader 重选举。需要满足一定的条件才会触发 Leader 重选举。</p>
<p>与 <code>unclean.leader.election.enable</code> 参数不同的是，<code>auto.leader.rebalance.enable</code>并不是选举新的 Leader，而是更换现有的 Leader。例如，如果 Leader<br>A 一直表现良好，但是当 <code>auto.leader.rebalance.enable</code> 为 true 时，经过一段时间后，Leader A 可能会被强制卸任，换成 Leader B。</p>
<p>需要注意的是，Leader 的更换代价很高。原本向 Leader A 发送请求的所有客户端都需要切换成向 Leader B 发送请求。而且这种 Leader 的更换本质上没有任何性能收益。</p>
<p>因此，在生产环境中，建议将 <code>auto.leader.rebalance.enable</code> 设置为 false，避免不必要的 Leader 更换。</p>
<h3 id="数据留存方面"><a href="# 数据留存方面" class="headerlink" title="数据留存方面"></a>数据留存方面 </h3><p> 在 Kafka 中，有一组参数用于控制数据的留存。下面我将逐个介绍这些参数。</p>
<ol>
<li><p><code>log.retention.&#123;hours|minutes|ms&#125;</code><br>：这是一组参数，用于控制消息数据在 Kafka 中保存的时间。这三个参数分别是以小时（hours）、分钟（minutes）和毫秒（ms）为单位的时间间隔。优先级上，ms 设置最高，minutes 次之，hours 最低。通常情况下，我们会设置较长的时间间隔，比如 log.retention.hours&#x3D;168 表示默认保存 7 天的数据，自动删除 7 天前的数据。如果将 Kafka 用作存储系统，那么这个值可能需要相应调大。</p>
</li>
<li><p><code>log.retention.bytes</code><br>：这个参数用于指定 Broker 在磁盘上保存的消息数据的总容量大小。默认值为 -1，表示没有容量限制，即可以保存任意大小的数据。这个参数在构建云上的多租户 Kafka 集群时发挥作用。假设你要提供一个云上的 Kafka 服务，每个租户只能使用 100GB 的磁盘空间，为了避免某个租户占用过多的磁盘空间，设置这个参数就非常重要了。</p>
</li>
<li><p><code>message.max.bytes</code><br>：这个参数用于控制 Broker 能够接收的最大消息大小。默认值为 1000012，即不到 1MB。然而，在实际场景中，超过 1MB 的消息是很常见的。因此，在生产环境中，将这个值设置得比较大是比较保险的做法。这个参数只是一个标尺，仅仅衡量 Broker 能够处理的最大消息大小，即使设置得大一点也不会占用太多磁盘空间。</p>
</li>
</ol>
<p>需要注意的是，这些参数都是可配置的，可以根据实际需求进行调整。在配置文件中，可以通过设置对应的属性来修改这些参数的值。例如，可以在 <code>server.properties</code><br> 文件中添加以下配置来修改 <code>log.retention.hours</code> 参数的值：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log.retention.hours</span>=<span class="number">168</span></span><br></pre></td></tr></table></figure>

<p>这样就将消息数据的保存时间设置为 7 天。</p>
<p>总结一下，这些参数在 Kafka 中起到了重要的作用，可以根据实际需求来调整，以满足不同的业务场景。</p>
<h3 id="Topic 级别参数"><a href="#Topic 级别参数" class="headerlink" title="Topic 级别参数"></a>Topic 级别参数</h3><p>Topic 级别的参数在 Kafka 中非常重要，它允许我们为每个 Topic 设置特定的参数值，这些参数会覆盖全局 Broker 参数的值。这样做的好处是可以根据不同的业务需求，为不同的 Topic 设置不同的参数，提高系统的灵活性和效率。</p>
<p>下面我将详细介绍几个重要的 Topic 级别参数，按照用途分组。</p>
<ol>
<li><p>保存消息方面的参数：</p>
<ul>
<li><code>retention.ms</code><br>：规定了该 Topic 消息被保存的时长。默认值是 7 天，即该 Topic 只保存最近 7 天的消息。如果设置了这个值，它会覆盖 Broker 端的全局参数值。通过设置不同的 retention.ms 值，我们可以根据业务需求来控制消息的保存时长，避免无效的数据占用过多的存储空间。</li>
<li><code>retention.bytes</code><br>：规定了为该 Topic 预留的磁盘空间大小。和全局参数的作用类似，这个值在多租户的 Kafka 集群中非常有用。默认值是 -1，表示可以无限使用磁盘空间。通过设置不同的 retention.bytes 值，我们可以根据不同的 Topic 的数据量来合理分配磁盘空间，避免存储空间不足的问题。</li>
</ul>
</li>
<li><p>处理消息大小方面的参数：</p>
<ul>
<li><code>max.message.bytes</code>：决定了 Kafka<br>Broker 能够正常接收该 Topic 的最大消息大小。在很多公司中，Kafka 作为基础架构组件运行，承载了大量的业务数据。如果在全局层面上无法给出一个合适的最大消息值，那么允许不同的业务部门自行设定 Topic 级别的 <code>max.message.bytes</code><br> 参数就显得非常必要了。通过设置不同的 <code>max.message.bytes</code> 值，我们可以根据不同的业务需求来控制消息的大小，确保系统能够正常处理各种大小的消息。</li>
</ul>
</li>
</ol>
<p>通过设置 Topic 级别的参数，我们可以根据不同的业务需求来灵活地调整 Kafka 的配置，提高系统的性能和可用性。同时，这也是 Kafka 作为一个高性能分布式消息系统的重要特性之一。</p>
<p>需要注意的是，Topic 级别的参数只对该 Topic 中的消息生效，不会影响其他 Topic。如果没有为某个 Topic 设置特定的参数值，那么将会使用全局 Broker 参数的默认值。</p>
<p>除了上述介绍的参数，Kafka 还有其他一些 Topic 级别的参数，如 <code>cleanup.policy</code>、<code>compression.type</code><br> 等，它们都可以根据具体的业务需求进行设置。在实际应用中，我们可以根据不同的场景和需求，灵活地使用这些参数来优化 Kafka 集群的性能和可靠性。</p>
<p>总结一下，Topic 级别的参数允许我们为每个 Topic 设置特定的参数值，覆盖全局 Broker 参数的值。通过设置不同的参数值，我们可以根据业务需求来控制消息的保存时长、磁盘空间使用和消息大小等，提高系统的灵活性和效率。这是 Kafka 作为一个高性能分布式消息系统的重要特性之一。</p>
<p>在 Kafka 中，可以通过两种方式来设置 Topic 级别的参数：在创建 Topic 时设置和修改已存在的 Topic 时设置。</p>
<p><strong>1. 创建 Topic 时设置参数</strong></p>
<p>在创建 Topic 时，可以通过 <code>--config</code> 参数来设置 Topic 级别的参数。例如，我们要创建一个名为 <code>transaction</code><br> 的 Topic，并设置 <code>retention.ms</code> 为 15552000000，<code>max.message.bytes</code>为 5242880，可以使用以下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-topics.sh --bootstrap-server localhost:9092 --create --topic transaction --partitions 1 --replication-factor 1 --config retention.ms=15552000000 --config max.message.bytes=5242880</span><br></pre></td></tr></table></figure>

<p>在上述命令中，<code>--config</code>后面的参数用于指定要设置的 Topic 级别参数。</p>
<p><strong>2. 修改已存在的 Topic 时设置参数</strong></p>
<p>可以使用 <code>kafka-configs</code> 命令来修改已存在的 Topic 的参数。假设我们要将 <code>transaction</code> Topic 的<code>max.message.bytes</code><br> 修改为 10485760，可以使用以下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-configs.sh --zookeeper localhost:2181 --entity-type topics --entity-name transaction --alter --add-config max.message.bytes=10485760</span><br></pre></td></tr></table></figure>

<p>在上述命令中，<code>--entity-type topics</code>表示要修改的实体类型为 Topic，<code>--entity-name transaction</code><br>表示要修改的 Topic 名称，<code>--alter</code>表示要进行修改操作，<code>--add-config</code>后面的参数用于指定要修改的 Topic 级别参数及其新值。</p>
<p><strong>个人建议</strong></p>
<p>个人建议始终坚持使用第二种方式来设置 Topic 级别参数，并且在未来，Kafka 社区很有可能统一使用 <code>kafka-configs</code><br> 脚本来调整 Topic 级别参数。这样做的好处是统一了设置参数的方式，减少了学习成本和混淆，同时也更加方便管理和维护。</p>
<h3 id="JVM 参数"><a href="#JVM 参数" class="headerlink" title="JVM 参数"></a>JVM 参数</h3><p>JVM 参数对于 Kafka 集群的性能和稳定性非常重要。在设置 JVM 参数之前，首先需要确定 Java 版本。对于 Kafka 来说，不推荐在 Java<br>6 或 7 的环境上运行，建议至少使用 Java 8。</p>
<p>在 JVM 参数设置中，堆大小是一个关键参数。尽管后面我们还会讨论如何调优 Kafka 性能的问题，但是现在我想给出一个通用的建议：将 JVM 堆大小设置为 6GB，这是目前业界普遍认可的一个合理值。很多人使用默认的堆大小来运行 Kafka，但是默认的 1GB 有点小，因为 Kafka<br>Broker 在与客户端进行交互时会在 JVM 堆上创建大量的 ByteBuffer 实例，堆大小不能太小。</p>
<p>另一个重要的 JVM 参数是垃圾回收器（GC）的设置。如果你仍在使用 Java<br>7，可以根据以下规则选择合适的垃圾回收器：如果 Broker 所在机器的 CPU 资源非常充裕，建议使用 CMS（Concurrent Mark<br>Sweep）收集器，启用方法是指定<code>-XX:+UseConcMarkSweepGC</code>。否则，使用吞吐量收集器，启用方法是指定<code>-XX:+UseParallelGC</code>。如果你使用 Java<br>8，可以手动设置使用 G1（Garbage First）收集器。在没有任何调优的情况下，G1 表现要比 CMS 更出色，主要体现在更少的 Full<br>GC 和需要调整的参数更少等方面，所以使用 G1 就可以了。</p>
<p>现在我们确定了要设置的 JVM 参数，接下来我们来为 Kafka 进行设置。奇怪的是，这个问题在 Kafka 官网上居然没有被提及。实际上，设置的方法非常简单，你只需要设置下面这两个环境变量即可：</p>
<ul>
<li><code>KAFKA_HEAP_OPTS</code>：指定堆大小。例如，你可以这样设置：<code>export KAFKA_HEAP_OPTS=&quot;-Xms6g -Xmx6g&quot;</code></li>
<li><code>KAFKA_JVM_PERFORMANCE_OPTS</code><br>：指定 GC 参数。例如，你可以这样设置：<code>export KAFKA_JVM_PERFORMANCE_OPTS=&quot;-server -XX:+UseG1GC -XX:MaxGCPauseMillis=20 -XX:InitiatingHeapOccupancyPercent=35 -XX:+ExplicitGCInvokesConcurrent -Djava.awt.headless=true&quot;</code></li>
</ul>
<p>在启动 Kafka Broker 之前，先设置好这两个环境变量，然后执行启动命令，例如：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">export</span> KAFKA_HEAP_OPTS=<span class="string">&quot;-Xms6g -Xmx6g&quot;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">export</span> KAFKA_JVM_PERFORMANCE_OPTS=<span class="string">&quot;-server -XX:+UseG1GC -XX:MaxGCPauseMillis=20 -XX:InitiatingHeapOccupancyPercent=35 -XX:+ExplicitGCInvokesConcurrent -Djava.awt.headless=true&quot;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">bin/kafka-server-start.sh config/server.properties</span></span><br></pre></td></tr></table></figure>

<p>这样就完成了 JVM 参数的设置。通过合理的设置，可以提高 Kafka 集群的性能和稳定性。需要注意的是，具体的参数设置可能因环境和需求而有所不同，可以根据实际情况进行调整。</p>
<h3 id="操作系统参数"><a href="# 操作系统参数" class="headerlink" title="操作系统参数"></a>操作系统参数</h3><p>Kafka 集群通常需要设置一些操作系统参数来优化性能和稳定性。下面是一些常见的操作系统参数设置：</p>
<ol>
<li><p><strong>文件描述符限制（ulimit -n）</strong>：文件描述符是操作系统用于跟踪打开文件的标识符。Kafka<br>集群需要同时打开大量的文件描述符，因此需要增加文件描述符限制。默认情况下，操作系统的文件描述符限制较低，可能会导致 Kafka<br>进程无法打开足够的文件描述符，从而影响性能。建议将文件描述符限制设置为一个较大的值，例如 ulimit -n 1000000。</p>
</li>
<li><p><strong>文件系统类型的选择 </strong>：Kafka 集群的性能和稳定性受到文件系统的影响。根据官方测试报告，XFS 文件系统的性能要优于 ext4<br> 文件系统。因此，在生产环境中最好选择 XFS 文件系统。最近也有一些关于 Kafka 使用 ZFS 文件系统的报告，显示其性能更强劲，如果条件允许，可以尝试使用<br>ZFS 文件系统。</p>
</li>
<li><p><strong>Swap 的调优 </strong>：Swap 是操作系统用于将内存中不常用的数据暂时存储在磁盘上的机制。一些文章建议将 Swap 设置为 0，完全禁用<br>Swap，以防止 Kafka 进程使用 Swap 空间。然而，个人认为最好不要将 Swap 设置为 0，而是设置为一个较小的值。这是因为当物理内存耗尽时，操作系统会触发<br>OOM killer 组件，随机选择一个进程并杀死它，而不给用户任何预警。如果将 Swap 设置为一个较小的值，当开始使用 Swap<br> 空间时，你至少能观察到 Broker 性能的急剧下降，从而有时间进行进一步的调优和问题诊断。建议将 swappiness 设置为接近 0 但不为<br>0 的值，例如 1。</p>
</li>
<li><p><strong>提交时间（Flush 落盘时间）</strong>：Kafka 发送数据时，并不需要等待数据被写入磁盘才认为成功，只要数据被写入操作系统的页缓存（Page<br>Cache）即可。操作系统会根据 LRU 算法定期将页缓存上的“脏”数据写入物理磁盘。提交时间决定了这个定期的间隔，默认为 5<br>秒。通常情况下，这个时间间隔可能太频繁，可以适当增加提交时间间隔来降低物理磁盘的写操作。需要注意的是，如果数据在写入磁盘之前发生机器宕机，数据将会丢失。但由于<br>Kafka 在软件层面提供了多副本的冗余机制，因此可以适当增加提交时间间隔以换取性能。</p>
</li>
</ol>
<p>需要注意的是，以上参数设置是一般情况下的建议，具体的设置还需要根据实际情况和硬件配置进行调整。另外，不同的操作系统和版本可能会有不同的参数设置方式，请参考相应的操作系统文档或官方建议进行设置。</p>
<p>下面是一个示例，展示如何在 Linux 系统上设置 ulimit -n 参数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前文件描述符限制</span></span><br><span class="line"><span class="built_in">ulimit</span> -n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改文件描述符限制为 1000000</span></span><br><span class="line"><span class="built_in">ulimit</span> -n 1000000</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证修改是否生效</span></span><br><span class="line"><span class="built_in">ulimit</span> -n</span><br></pre></td></tr></table></figure>

<p>请注意，以上示例仅适用于 Linux 系统，其他操作系统可能有不同的设置方式。</p>
<!-- md plan/kafka.md -->

</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {selector: '.gallery-item'};
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div>
				<link rel="stylesheet" type="text/css" href="https://qiniu.techgrow.cn/readmore/dist/hexo.css">
				<script src="https://qiniu.techgrow.cn/readmore/dist/readmore.js" type="text/javascript"></script>
				<script>
				var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);
				var isEncrypt = document.getElementById('hexo-blog-encrypt');
				var allowMobile = false;
				if (!isEncrypt && (!isMobile || (isMobile && allowMobile))) {
					try {
						var plugin = new ReadmorePlugin();
						plugin.init({
							"type": "hexo",
							"id": "readmore-container",
							"name": "程序员朱永胜",
							"blogId": "39259-6450029321246-893",
							"qrcode": "https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/blog/202308142242856.jpg",
							"keyword": "1",
							"random": "1",
							"height": "auto",
							"expires": "365",
							"lockToc": "yes",
							"interval": "60",
							"baseUrl": ""
						});
					} catch(e) {
						console.warn("readmore plugin occurred error: " + e.name + " | " + e.message);
					}
				}
				</script>
			</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="index.html" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/aliyun/202308012321669.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/aliyun/202308012321669.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">程序员朱永胜</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://blog.zysicyj.top/kafka2.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://blog.zysicyj.top/kafka2.html')">【Kafka 系列】（二）Kafka 的基本使用</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/blog/202308142337659.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/blog/202308142337659.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/blog/202308142338230.png" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/blog/202308142338230.png" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://blog.zysicyj.top/kafka2.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=undefined&amp;url=https://blog.zysicyj.top/kafka2.html&amp;pic=undefined" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.zysicyj.top" target="_blank"></a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"></div><div class="post_share"><div class="social-share" data-image="https://img.xjh.me/random_img.php?return=302&amp;_r_=e581a462-d049-3c06-fb43-e77dac8f21c3" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="2ccef498.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&amp;_r_=2a2e0560-d11c-9216-d5d7-272056a5fd93" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【日记】9 月 17 日</div></div></a></div><div class="next-post pull-right"><a href="eb922c4a.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&amp;_r_=f9993c45-3d9b-b452-ed3d-77753c0c1788" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">为什么 G1 收集器不需要调优性能也很优秀</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="plan.html" title="【日记】文章更新计划"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&_r_=bbe818f9-f648-4f8f-5ad5-755cfd2a5afe" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-history fa-fw"></i> 2025-01-22</div><div class="title">【日记】文章更新计划</div></div></a></div><div><a href="eb922c4a.html" title="为什么 G1 收集器不需要调优性能也很优秀"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&_r_=f9993c45-3d9b-b452-ed3d-77753c0c1788" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-history fa-fw"></i> 2025-01-22</div><div class="title">为什么 G1 收集器不需要调优性能也很优秀</div></div></a></div><div><a href="kafka1.html" title="【Kafka 系列】Kafka 入门"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&_r_=36cb6499-30f1-2b60-43d7-9b8cc25df8e2" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-history fa-fw"></i> 2025-01-22</div><div class="title">【Kafka 系列】Kafka 入门</div></div></a></div><div><a href="9f426eea.html" title="【Linux 系列】vmware 虚拟机网络配置详解"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&_r_=160df8a1-85ff-fdc5-39e7-7d06aaf10628" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-history fa-fw"></i> 2025-01-22</div><div class="title">【Linux 系列】vmware 虚拟机网络配置详解</div></div></a></div><div><a href="4e7b516e.html" title="【Linux 系列】使用虚拟机安装 Linux 系统"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&_r_=94ac3a9c-5c7d-db41-8213-f1f68fe25858" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-history fa-fw"></i> 2025-01-22</div><div class="title">【Linux 系列】使用虚拟机安装 Linux 系统</div></div></a></div><div><a href="6a27ead0.html" title="【Linux 系列】离线安装 openjdk17 的 rpm 包"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&_r_=9a5d08b0-dac5-56c1-7edc-9da7e7ac2322" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-history fa-fw"></i> 2025-01-22</div><div class="title">【Linux 系列】离线安装 openjdk17 的 rpm 包</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/aliyun/202308012321669.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">程序员朱永胜</h1><div class="author-info__desc"></div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="mailto:zhuyongsheng@xxc99.cn" rel="external nofollow noreferrer" target="_blank" title="fas fa-envelope"></a><a class="social-icon faa-parent animated-hover" href="https://blog.csdn.net/njpkhuan" rel="external nofollow noreferrer" target="_blank" title="fa-solid fa-blog fa-beat"></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/258577429" rel="external nofollow noreferrer" target="_blank" title="fa-brands fa-bilibili"></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://img02.anheyu.com/adminuploads/1/2022/09/11/631ddb7c9b250.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://blog-1253652709.cos.ap-guangzhou.myqcloud.com/tc/%E6%89%AB%E7%A0%81_%E6%90%9C%E7%B4%A2%E8%81%94%E5%90%88%E4%BC%A0%E6%92%AD%E6%A0%B7%E5%BC%8F-%E6%A0%87%E5%87%86%E8%89%B2%E7%89%88.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Kafka%20%E7%BA%BF%E4%B8%8A%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88%E6%80%8E%E4%B9%88%E5%81%9A"><span class="toc-number">1.</span> <span class="toc-text">Kafka 线上集群部署方案怎么做 </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.</span> <span class="toc-text"> 操作系统 </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#I-O%20%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">I&#x2F;O 模型 </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%B6%E6%8B%B7%E8%B4%9D"><span class="toc-number">1.1.2.</span> <span class="toc-text">零拷贝</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A3%81%E7%9B%98"><span class="toc-number">1.2.</span> <span class="toc-text">磁盘 </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%B4%20Kafka%20%E5%8F%AF%E4%BB%A5%E4%B8%8D%E6%90%AD%E5%BB%BA%20RAID%20%E7%8E%AF%E5%A2%83"><span class="toc-number">1.2.1.</span> <span class="toc-text">为什么说 Kafka 可以不搭建 RAID 环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%B4%E4%BD%BF%E7%94%A8%E6%9C%BA%E6%A2%B0%E7%A3%81%E7%9B%98%E5%AE%8C%E5%85%A8%E8%83%BD%E5%A4%9F%E8%83%9C%E4%BB%BB%20Kafka%20%E7%BA%BF%E4%B8%8A%E7%8E%AF%E5%A2%83"><span class="toc-number">1.2.2.</span> <span class="toc-text">为什么说使用机械磁盘完全能够胜任 Kafka 线上环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E5%AE%B9%E9%87%8F"><span class="toc-number">1.3.</span> <span class="toc-text">磁盘容量 </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%A6%E5%AE%BD"><span class="toc-number">1.4.</span> <span class="toc-text">带宽 </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">1.5.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">集群参数配置 </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E5%8F%82%E6%95%B0%E5%92%8C%E5%8A%A8%E6%80%81%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.</span> <span class="toc-text"> 静态参数和动态参数 </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Broker"><span class="toc-number">2.2.</span> <span class="toc-text">Broker</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E7%9B%B8%E5%85%B3"><span class="toc-number">2.2.1.</span> <span class="toc-text">磁盘相关 </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Zookeeper%20%E7%9B%B8%E5%85%B3"><span class="toc-number">2.2.2.</span> <span class="toc-text">Zookeeper 相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Broker%20%E7%9B%B8%E5%85%B3"><span class="toc-number">2.2.3.</span> <span class="toc-text">Broker 相关 </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Topic%20%E7%9B%B8%E5%85%B3"><span class="toc-number">2.2.4.</span> <span class="toc-text">Topic 相关 </span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#auto-create-topics-enable"><span class="toc-number">2.2.4.1.</span> <span class="toc-text">auto.create.topics.enable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#unclean-leader-election-enable"><span class="toc-number">2.2.4.2.</span> <span class="toc-text">unclean.leader.election.enable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#auto-leader-rebalance-enable"><span class="toc-number">2.2.4.3.</span> <span class="toc-text">auto.leader.rebalance.enable</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%95%99%E5%AD%98%E6%96%B9%E9%9D%A2"><span class="toc-number">2.2.5.</span> <span class="toc-text">数据留存方面 </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Topic%20%E7%BA%A7%E5%88%AB%E5%8F%82%E6%95%B0"><span class="toc-number">2.2.6.</span> <span class="toc-text">Topic 级别参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JVM%20%E5%8F%82%E6%95%B0"><span class="toc-number">2.2.7.</span> <span class="toc-text">JVM 参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8F%82%E6%95%B0"><span class="toc-number">2.2.8.</span> <span class="toc-text">操作系统参数</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="../post/redis-memory-elimination-strategy-onnlh.html" title="redis 内存淘汰策略"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&amp;_r_=240758f3-ca3c-dbe8-cd48-322d3671f1dc" onerror="this.onerror=null;this.src='../img/404.jpg'" alt="redis 内存淘汰策略"/></a><div class="content"><a class="title" href="../post/redis-memory-elimination-strategy-onnlh.html" title="redis 内存淘汰策略">redis 内存淘汰策略</a><time datetime="2025-01-22T15:08:58.000Z" title="更新于 2025-01-22 15:08:58">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="../post/nacos-24-guide-to-security-practice-open-permission-certification-configure-the-default-account-password-and-mysql-integration-1fwsrh.html" title="Nacos 2.4 安全实践指南：开启权限认证、配置默认账号密码与 MySQL 集成"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&amp;_r_=e581a462-d049-3c06-fb43-e77dac8f21c3" onerror="this.onerror=null;this.src='../img/404.jpg'" alt="Nacos 2.4 安全实践指南：开启权限认证、配置默认账号密码与 MySQL 集成"/></a><div class="content"><a class="title" href="../post/nacos-24-guide-to-security-practice-open-permission-certification-configure-the-default-account-password-and-mysql-integration-1fwsrh.html" title="Nacos 2.4 安全实践指南：开启权限认证、配置默认账号密码与 MySQL 集成">Nacos 2.4 安全实践指南：开启权限认证、配置默认账号密码与 MySQL 集成</a><time datetime="2025-01-22T15:03:59.000Z" title="更新于 2025-01-22 15:03:59">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="../2ccef498.html" title="【日记】9 月 17 日"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&amp;_r_=2a2e0560-d11c-9216-d5d7-272056a5fd93" onerror="this.onerror=null;this.src='../img/404.jpg'" alt="【日记】9 月 17 日"/></a><div class="content"><a class="title" href="../2ccef498.html" title="【日记】9 月 17 日">【日记】9 月 17 日</a><time datetime="2025-01-22T07:09:19.264Z" title="更新于 2025-01-22 07:09:19">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="../74ade4ce.html" title="【日记】9 月 18 日"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&amp;_r_=ea7ba1aa-f55c-4098-87f4-6181e8f8b69e" onerror="this.onerror=null;this.src='../img/404.jpg'" alt="【日记】9 月 18 日"/></a><div class="content"><a class="title" href="../74ade4ce.html" title="【日记】9 月 18 日">【日记】9 月 18 日</a><time datetime="2025-01-22T07:09:19.264Z" title="更新于 2025-01-22 07:09:19">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="../fc98205f.html" title="【日记】2023 年 9 月 5 日"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.xjh.me/random_img.php?return=302&amp;_r_=43538029-41e7-39aa-6758-68d6a3172b69" onerror="this.onerror=null;this.src='../img/404.jpg'" alt="【日记】2023 年 9 月 5 日"/></a><div class="content"><a class="title" href="../fc98205f.html" title="【日记】2023 年 9 月 5 日">【日记】2023 年 9 月 5 日</a><time datetime="2025-01-22T07:09:19.264Z" title="更新于 2025-01-22 07:09:19">2025-01-22</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><div id="runtimeTextTip"></div></div><div class="footer_custom_text"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://beian.miit.gov.cn/"><span>苏ICP备2024066768号-1</span></a></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2023 - 2025 By <a class="footer-bar-link" href="index.html" title="程序员朱永胜" target="_blank">程序员朱永胜</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="archives/" title="archive"><div class="headline">文章</div><div class="length-num">1222</div></a><a href="tags/" title="tag"><div class="headline">标签</div><div class="length-num">901</div></a><a href="categories/" title="category"><div class="headline">分类</div><div class="length-num">14</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" rel="external nofollow noreferrer" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.zysicyj.top/" title="个人主页"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/13/64d8c2748ef34.jpg" alt="个人主页"/><span class="back-menu-item-text">个人主页</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">写作软件</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://editor.runjs.cool/post?id=demo" title="Mdx"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4296739868700.png" alt="Mdx"/><span class="back-menu-item-text">Mdx</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://openwrite.cn/" title="OpenWrite"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://openwrite.cn/logo.png" alt="OpenWrite"/><span class="back-menu-item-text">OpenWrite</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jetbrains.com/zh-cn/writerside/" title="WriteSide"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="data:image/jpeg;base64,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" alt="WriteSide"/><span class="back-menu-item-text">WriteSide</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">开发工具</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jetbrains.com/zh-cn/idea/" title="idea"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4576710485000.png" alt="idea"/><span class="back-menu-item-text">idea</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jetbrains.com/zh-cn/datagrip/" title="DataGrip"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4604435065400.png" alt="DataGrip"/><span class="back-menu-item-text">DataGrip</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4663369180700.png" title="WebStorm"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4604435065400.png" alt="WebStorm"/><span class="back-menu-item-text">WebStorm</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" title="微信开发者工具"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4743988475500.png" alt="微信开发者工具"/><span class="back-menu-item-text">微信开发者工具</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" title="HBuilder"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://www.dcloud.io/hbuilderx.html" alt="HBuilder"/><span class="back-menu-item-text">HBuilder</span></a><a class="back-menu-item" target="_blank" rel="noopener external nofollow noreferrer" href="https://mobaxterm.mobatek.net/" title="MobaXterm"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://blog-1253652709.cos.ap-guangzhou.myqcloud.com/pasteimageintomarkdown/2024-07-16/4849682167700.png" alt="MobaXterm"/><span class="back-menu-item-text">MobaXterm</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="index.html"><i class="fas fa-home faa-tada"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-link faa-tada"></i><span> 目录</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="fas fa-archive faa-tada"></i><span> 时间轴</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="fas fa-folder-open faa-tada"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-list faa-tada"></i><span> 清单</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/movies/"><i class="fas fa-video faa-tada"></i><span> 电影</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/books/"><i class="fas fa-book faa-tada"></i><span> 阅读</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/songs/"><i class="fas fa-music faa-tada"></i><span> 音乐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="fa-brands fa-bilibili faa-tada"></i><span> 追番</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/cinemas/"><i class="fa-brands fa-bilibili faa-tada"></i><span> 追剧</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="fas fa-link faa-tada"></i><span> 友链</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/gallery/"><i class="fas fa-solid fa-image faa-tada"></i><span> 相册集</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/love/static/index.html"><i class="fas fa-heart faa-tada"></i><span> Love</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="fa-solid fa-user faa-tada"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="fa-solid  fa-comment faa-tada"></i><span> 闲言碎语</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span></div></div><div id="keyboard-tips"><div class="keyboardTitle">博客快捷键</div><div class="keybordList"><div class="keybordItem"><div class="keyGroup"><div class="key">shift K</div></div><div class="keyContent"><div class="content">关闭快捷键功能</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift A</div></div><div class="keyContent"><div class="content">打开/关闭中控台</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift M</div></div><div class="keyContent"><div class="content">播放/暂停音乐</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift D</div></div><div class="keyContent"><div class="content">深色/浅色显示模式</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift S</div></div><div class="keyContent"><div class="content">站内搜索</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift R</div></div><div class="keyContent"><div class="content">随机访问</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift H</div></div><div class="keyContent"><div class="content">返回首页</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift F</div></div><div class="keyContent"><div class="content">友链鱼塘</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift L</div></div><div class="keyContent"><div class="content">友链页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift P</div></div><div class="keyContent"><div class="content">关于本站</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift I</div></div><div class="keyContent"><div class="content">原版/本站右键菜单</div></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="js/utils.js"></script><script src="js/main.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("07/01/2023 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2023 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 程序员朱永胜 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("07/01/2023 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="js/search/local-search.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>